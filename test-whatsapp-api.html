<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp API Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #f9f9f9;
        }
        .test-section h3 {
            color: #555;
            margin-top: 0;
        }
        button {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .result {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        .api-details {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #25D366;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ WhatsApp API Test Suite</h1>
        
        <div class="api-details">
            <h4>üìã API Configuration</h4>
            <p><strong>Webhook URL:</strong> https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08</p>
            <p><strong>Test Number:</strong> +91 8485877633</p>
            <p><strong>Working Message:</strong> ondocompany,abc123,19/09/2025,abhishek,8485877633,ram2@gmail.com,https://royal-pazz.vercel.app/login</p>
            <p><strong>Status:</strong> ‚úÖ Successfully tested and working</p>
        </div>

        <div class="test-section">
            <h3>üìù Custom User Message Test</h3>
            <p>Enter user details and send WhatsApp message</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 1rem 0;">
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">User Phone Number:</label>
                    <input type="text" id="userPhone" value="8485877633" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">User ID:</label>
                    <input type="text" id="userId" value="abc123" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Joining Date:</label>
                    <input type="text" id="joiningDate" value="19/09/2025" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">User Name:</label>
                    <input type="text" id="userName" value="abhishek" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">User Email:</label>
                    <input type="text" id="userEmail" value="ram2@gmail.com" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                </div>
            </div>
            
            <button onclick="sendCustomUserMessage()" id="customBtn" style="margin-top: 1rem;">üì± Send WhatsApp Message</button>
            <div id="customResult"></div>
        </div>

        <div class="test-section">
            <h3>üîó Direct API Test (Fixed)</h3>
            <p>Test the exact URL you provided with the same parameters</p>
            <button onclick="testDirectAPI()" id="directBtn">Test Direct API Call</button>
            <div id="directResult"></div>
        </div>

        <div class="test-section">
            <h3>üì± Formatted Welcome Message Test</h3>
            <p>Test with properly formatted welcome message using your parameters</p>
            <button onclick="testFormattedMessage()" id="formattedBtn">Test Formatted Message</button>
            <div id="formattedResult"></div>
        </div>

        <div class="test-section">
            <h3>üß™ Custom Message Test</h3>
            <p>Send a simple test message to verify API connectivity</p>
            <button onclick="testSimpleMessage()" id="simpleBtn">Test Simple Message</button>
            <div id="simpleResult"></div>
        </div>

        <div class="test-section">
            <h3>üîç Debug Information</h3>
            <p>Check browser console (F12) for detailed API response logs</p>
            <button onclick="showDebugInfo()" id="debugBtn">Show Debug Info</button>
            <div id="debugResult"></div>
        </div>
    </div>

    <script>
        // Direct API test using your exact URL
        async function testDirectAPI() {
            const btn = document.getElementById('directBtn');
            const result = document.getElementById('directResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>Testing...';
            
            const testUrl = 'https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08?number=918485877633&message=ondocompany,abc123,19/09/2025,abhishek,8485877633,ram2@gmail.com,https://royal-pazz.vercel.app/login';
            
            try {
                result.innerHTML = '<div class="info">üîÑ Sending request to WhatsApp API...</div>';
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                const responseText = await response.text();
                
                if (response.ok) {
                    result.innerHTML = `<div class="success">‚úÖ SUCCESS!
Status: ${response.status} ${response.statusText}
Response: ${responseText}</div>`;
                } else {
                    result.innerHTML = `<div class="error">‚ùå FAILED!
Status: ${response.status} ${response.statusText}
Response: ${responseText}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå ERROR!
${error.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Test Direct API Call';
            }
        }

        // Test with formatted welcome message
        async function testFormattedMessage() {
            const btn = document.getElementById('formattedBtn');
            const result = document.getElementById('formattedResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>Testing...';
            
            // Using the working format with new custom parameters
            const welcomeMessage = `Welcome to ONDO Company! User ID: abc123, Date: 19/09/2025, Name: abhishek, Mobile: 8485877633, Email: ram2@gmail.com, Portal: https://royal-pazz.vercel.app/login`;

            const testUrl = `https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08?number=918485877633&message=${encodeURIComponent(welcomeMessage)}`;
            
            try {
                result.innerHTML = '<div class="info">üîÑ Sending formatted welcome message...</div>';
                
                console.log('Formatted Message URL:', testUrl);
                console.log('Message length:', welcomeMessage.length);
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                const responseText = await response.text();
                
                console.log('Formatted Message Response:', {
                    status: response.status,
                    statusText: response.statusText,
                    body: responseText
                });
                
                if (response.ok) {
                    result.innerHTML = `<div class="success">‚úÖ SUCCESS!
Status: ${response.status} ${response.statusText}
Response: ${responseText}

Message sent:
${welcomeMessage}</div>`;
                } else {
                    result.innerHTML = `<div class="error">‚ùå FAILED!
Status: ${response.status} ${response.statusText}
Response: ${responseText}
URL Length: ${testUrl.length}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå ERROR!
${error.message}
URL: ${testUrl.substring(0, 200)}...</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Test Formatted Message';
            }
        }

        // Test with simple message
        async function testSimpleMessage() {
            const btn = document.getElementById('simpleBtn');
            const result = document.getElementById('simpleResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>Testing...';
            
            const simpleMessage = 'Hello from ONDO Company!';
            const testUrl = `https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08?number=918485877633&message=${encodeURIComponent(simpleMessage)}`;
            
            try {
                result.innerHTML = '<div class="info">üîÑ Sending simple test message...</div>';
                
                console.log('Simple Message URL:', testUrl);
                console.log('Message length:', simpleMessage.length);
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                const responseText = await response.text();
                
                console.log('Simple Message Response:', {
                    status: response.status,
                    statusText: response.statusText,
                    body: responseText
                });
                
                if (response.ok) {
                    result.innerHTML = `<div class="success">‚úÖ SUCCESS!
Status: ${response.status} ${response.statusText}
Response: ${responseText}

Message sent: "${simpleMessage}"</div>`;
                } else {
                    result.innerHTML = `<div class="error">‚ùå FAILED!
Status: ${response.status} ${response.statusText}
Response: ${responseText}
URL Length: ${testUrl.length}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå ERROR!
${error.message}
URL: ${testUrl.substring(0, 200)}...</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Test Simple Message';
            }
        }

        // Debug information function
        function showDebugInfo() {
            const result = document.getElementById('debugResult');
            
            const debugInfo = `
API Endpoint: https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08
Test Number: +91 8485877633

Direct API Message (Working): ondocompany,abc123,19/09/2025,abhishek,8485877633,ram2@gmail.com,https://royal-pazz.vercel.app/login

Formatted Message: Welcome to ONDO Company! User ID: abc123, Date: 19/09/2025, Name: abhishek, Mobile: 8485877633, Email: ram2@gmail.com, Portal: https://royal-pazz.vercel.app/login

Simple Message: Hello from ONDO Company!

Possible Issues:
1. URL encoding differences
2. Message length limits
3. Special characters in formatted messages
4. API rate limiting
5. CORS restrictions

Check browser console (F12) for detailed logs.
            `;
            
            result.innerHTML = `<div class="info">${debugInfo}</div>`;
        }

        // Custom user message function
        async function sendCustomUserMessage() {
            const btn = document.getElementById('customBtn');
            const result = document.getElementById('customResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>Sending...';
            
            // Get user input values
            const userPhone = document.getElementById('userPhone').value;
            const userId = document.getElementById('userId').value;
            const joiningDate = document.getElementById('joiningDate').value;
            const userName = document.getElementById('userName').value;
            const userEmail = document.getElementById('userEmail').value;
            
            // Create message in the working format
            const message = `ondocompany,${userId},${joiningDate},${userName},${userPhone},${userEmail},https://royal-pazz.vercel.app/login`;
            
            // Create API URL
            const testUrl = `https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08?number=91${userPhone}&message=${message}`;
            
            try {
                result.innerHTML = '<div class="info">üîÑ Sending WhatsApp message...</div>';
                
                console.log('Custom Message URL:', testUrl);
                console.log('Message:', message);
                console.log('Phone Number:', `+91${userPhone}`);
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                const responseText = await response.text();
                
                console.log('Custom Message Response:', {
                    status: response.status,
                    statusText: response.statusText,
                    body: responseText
                });
                
                if (response.ok) {
                    result.innerHTML = `<div class="success">‚úÖ SUCCESS!
Status: ${response.status} ${response.statusText}
Response: ${responseText}

Message sent to: +91${userPhone}
User: ${userName}
Message: ${message}</div>`;
                } else {
                    result.innerHTML = `<div class="error">‚ùå FAILED!
Status: ${response.status} ${response.statusText}
Response: ${responseText}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå ERROR!
${error.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'üì± Send WhatsApp Message';
            }
        }

        // Auto-run direct API test on page load
        window.addEventListener('load', () => {
            console.log('üöÄ WhatsApp API Test Suite loaded');
            console.log('Ready to test API endpoint: https://webhook.whatapi.in/webhook/68c8001cbde42bbd90745a08');
        });
    </script>
</body>
</html>
